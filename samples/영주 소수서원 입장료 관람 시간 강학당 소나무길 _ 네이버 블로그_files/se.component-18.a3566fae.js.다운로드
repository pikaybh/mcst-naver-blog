(window.__se_viewer_jsonp=window.__se_viewer_jsonp||[]).push([[36],{497:function(e,t,a){"use strict";a.r(t),a.d(t,"MapComponent",function(){return f});a(39),a(38),a(51),a(53),a(74),a(20),a(78),a(37);var n=a(155),o=a.n(n),s=a(30),i=a.n(s),r=a(64),c="업체 정보가 변경되었습니다. 네이버 지도에서 업체 정보를 다시 확인해 주세요",l="일시적인 오류로 전화번호를 조회할 수 없습니다.\n잠시 후에 다시 이용해 주세요.",p="일시적인 오류로 장소를 저장할 수 없습니다.\n잠시 후에 다시 이용해 주세요.",d="일시적인 오류로 장소 저장을 취소할 수 없습니다.\n잠시 후에 다시 이용해 주세요.",m="알 수 없는 오류가 발생하였습니다.\n잠시 후에 다시 이용해 주세요.",h="로그인 후 장소 저장이 가능합니다. 로그인 하시겠습니까?",u=400,_=401,g=405,k='<a href="https://m.place.naver.com/my/?tab=place" target="_blank" class="se-placesMap-bookmark-layer se-placesMap-bookmark-layer-saved"><p class="se-placesMap-bookmark-contents">관심장소로 저장되었습니다.<br><span class="se-placesMap-bookmark-contents-highlight">MY 플레이스 가기</span></p></a>',f=function(e){function t(t){var a,n=t.initData,s=t.config,i=t.componentConfig,c=t.instanceStatus;if(a=e.call(this,c)||this,"naver"!==n.searchEngine)return a.__ON_READY_COMPONENT__("map"),o()(a);a._serviceId=s.serviceConfig.serviceId,a._dialNumberAPI=r.d.PLACE_API_HOST+"/my/external/places/",a._bookmarkAPI=r.d.PLACE_API_HOST+"/my/external/bookmarks/",a._config=s||{},a._componentConfig=i||{},a._mapData=n||{},a.isMobile=r.e.isMobile(),a._htConst={htServiceId:{BLOG:"blog",POST:"post",STOREFARM:"storefarm"},htBizCatcher:{sCallSource:{blog:"BLOG",post:"POST",storefarm:"STORE"}}};var l=[];return a.isMobile?(a._componentConfig.showDialBtn&&l.push("https://ssl.pstatic.net/adimg3.search/adpost/js/ad.js"),a._componentConfig.showBookmarkBtn&&(a._debounceSaveBookmark=r.e.debounce(a._saveBookmark,1e3))):a._componentConfig.isDynamicMap&&"map_text"!==n.layout&&l.push("https://oapi.map.naver.com/openapi/maps3.js"),0===l.length?(a._init(),a.__ON_READY_COMPONENT__("map")):r.e.loadScript(l).then(function(){a._init(),a.__ON_READY_COMPONENT__("map")}),a}i()(t,e);var a=t.prototype;return a._init=function(){this._assignElements(),this._renderAdditionalBtn(),this._componentConfig.isDynamicMap&&!this.isMobile&&"map_text"!==this._mapData.layout&&this._activateDynamicMap()},a._renderAdditionalBtn=function(){var e=this;this._$section.find(".__se_link").each(function(t,a){var n=document.createDocumentFragment(),o=JSON.parse(a.getAttribute("data-linkdata")),s=e._getBookingBtnElement(o),i=e._getPhoneBtnElement(o),r=e._getBookmarkBtnElement(o);r&&n.appendChild(r),s&&n.appendChild(s),i&&n.appendChild(i);var c=a.parentNode;c&&c.appendChild(n)})},a._getBookingBtnElement=function(e){var t=null;return this._componentConfig.showBookingBtn&&e.bookingUrl&&"naver"===e.searchEngine&&(t=$seJq.parseHTML($seJq.trim('\n                <div class="se-placesMap-additional-button-wrap">\n                    <a href="'+r.e.replaceSpecialChar(e.bookingUrl)+'" target="_blank" class="se-placesMap-additional-button se-placesMap-button-reservation" title="예약하기">\n                        <span class="se-placesMap-additional-button-label">예약</span>\n                    </a>\n                </div>\n            '))[0]),t},a._getPhoneBtnElement=function(e){var t=null;return this._componentConfig.showDialBtn&&r.e.validateTel(e.tel)&&this.isMobile&&(t=$seJq.parseHTML($seJq.trim('\n                <div class="se-placesMap-additional-button-wrap">\n                    <a href="tel:'+e.tel+'" class="se-placesMap-additional-button se-placesMap-button-call" title="전화걸기" data-for-biz-catcher="mainNumber='+e.tel+"&callSource="+this._htConst.htBizCatcher.sCallSource[this._serviceId]+"&description="+e.placeId+'">\n                        <span class="se-placesMap-additional-button-label">전화</span>\n                    </a>\n                </div>\n            '))[0]).addEventListener("click",this._onClickPhoneBtn.bind(this,e)),t},a._getBookmarkBtnElement=function(e){var t=null;return this._componentConfig.showBookmarkBtn&&e.searchType&&this.isMobile&&(t=$seJq.parseHTML($seJq.trim('\n                <div class="se-placesMap-additional-button-wrap">\n                    <button type="button" class="se-placesMap-additional-button se-placesMap-button-bookmark" title="즐겨찾는 곳">\n                        <span class="se-placesMap-additional-button-label">저장</span>\n                    </button>\n                </div>\n            '))[0]).addEventListener("click",this._onClickBookmark.bind(this,e,t)),t},a._onClickPhoneBtn=function(e,t){t.preventDefault();var a=$seJq(event.currentTarget),n=e.placeId;this._requestDialInfo(n,this._onSuccessDialNumber.bind(this,a,n),this._onFailDialNumber.bind(this))},a._requestDialInfo=function(e,t,a){$seJq.ajax({url:""+this._dialNumberAPI+e,method:"GET",success:t,error:a,timeout:a})},a._onSuccessDialNumber=function(e,t,a){var n,o=a.message;if(o){var s=o.result,i=o.error;if(s){var r=s.base;n=r.virtualPhone||r.phone}else if(i)return void this._hanleError(i)}n?this._dial(e,t,n):alert(c)},a._hanleError=function(e){"API_ERR_002"===e.code?alert(c):alert(l)},a._onFailDialNumber=function(){alert(l)},a._getUpdatedDialBtn=function(e,t,a){var n=$seJq(e.find(".se-placesMap-button-call")[0]),o="tel:"+a;return n.attr("href",o),n.attr("data-for-biz-catcher","mainNumber="+a+"&callSource="+this._htConst.htBizCatcher.sCallSource[this._serviceId]+"&description="+t),n},a._dial=function(e,t,a){var n=this._getUpdatedDialBtn(e,t,a);sendToBizCatcher(n[0])},a._onClickBookmark=function(e,t,a){var n=$seJq(a.target),o=$seJq(t),s=n.hasClass("se-placesMap-button-bookmark-saved");this._debounceSaveBookmark&&this._debounceSaveBookmark(s,e,o)},a._assignElements=function(){this._$component=$seJq("#"+this._mapData.id),this._$section=this._$component.find(".se-section-placesMap"),this._$seModuleMap=this._$component.find(".se-module-map-image"),this._$seModuleMapImage=this._$component.find(".se-map-image")},a._activateDynamicMap=function(){try{var e=this._$seModuleMapImage.width(),t=this._$seModuleMapImage.height()/e*100,a=$seJq('<div class="__se_map se-dynamic-map"></div>');this._$seModuleMap.css({"padding-top":t+"%"}),this._$seModuleMap.prepend(a),this._$seModuleMapImage.hide(),this._createMap(a),this._makeMarkers()}catch(e){this._$seModuleMapImage.show()}},a._createMap=function(e){var t=Object.assign({useStyleMap:!0,zoomControl:!0,zoomControlOptions:{style:naver.maps.ZoomControlStyle.SMALL,position:naver.maps.Position.TOP_RIGHT},scrollWheel:!1},this._resolveFitboundOrCenter());this._map=new naver.maps.Map(e[0],t),t.bounds&&this._map.fitBounds(t.bounds,{top:42,bottom:42,left:32,right:32})},a._makeMarkers=function(){var e=this,t=this._mapData.places,a=this._makeMarkerIconUrls(t);t.forEach(function(t,n){var o=t.latlng;try{new naver.maps.Marker({position:new naver.maps.LatLng(o.latitude,o.longitude),map:e._map,icon:{url:a[n],size:{width:32,height:42},scaledSize:{width:32,height:42},anchor:{x:16,y:40}}})}catch(e){console.log(e)}})},a._makeMarkerIconUrls=function(e){return 1===e.length?["https://editor-static.pstatic.net/c/resources/common/img/common-icon-places-marker-x2-20180920.png"]:["https://editor-static.pstatic.net/c/resources/common/img/common-icon-place-1-x2-20180920.png","https://editor-static.pstatic.net/c/resources/common/img/common-icon-place-2-x2-20180920.png","https://editor-static.pstatic.net/c/resources/common/img/common-icon-place-3-x2-20180920.png","https://editor-static.pstatic.net/c/resources/common/img/common-icon-place-4-x2-20180920.png","https://editor-static.pstatic.net/c/resources/common/img/common-icon-place-5-x2-20180920.png"]},a._resolveFitboundOrCenter=function(){var e=this._mapData.places;if(1===e.length){var t=e[0].latlng;return{zoom:17,center:new naver.maps.LatLng(t.latitude,t.longitude)}}var a=e.map(function(e){var t=e.latlng;return{lat:t.latitude,lng:t.longitude}});return{bounds:naver.maps.LatLngBounds.bounds.apply(null,a)}},a._saveBookmark=function(e,t,a){e?this._deleteBookmark(t,a):this._checkBookmark(t,a)},a._deleteBookmark=function(e,t){$seJq.ajax(this._bookmarkAPI+e.placeId,{method:"DELETE",dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(){this._toggle(t)}.bind(this),error:function(){alert(d)}})},a._checkBookmark=function(e,t){$seJq.ajax(this._bookmarkAPI+e.placeId,{method:"GET",dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(a){a.bookmarkId?(this._toggle(t),this._showSavedGuide(t)):this._addBookmark(e,t)}.bind(this),error:function(e){var t=e.status;t===g||t===_?window.confirm(h)&&(document.location="https://nid.naver.com/nidlogin.login?svctype=262144"):alert(m)}.bind(this)})},a._addBookmark=function(e,t){$seJq.ajax(this._bookmarkAPI,{method:"POST",dataType:"json",contentType:"application/json; charset=utf-8",xhrFields:{withCredentials:!0},crossDomain:!0,data:JSON.stringify({address:e.address,name:e.name,px:parseFloat(e.longitude),py:parseFloat(e.latitude),placeId:e.placeId}),success:function(){this._toggle(t),this._showSavedGuide(t)}.bind(this),error:function(e){if(e.status!==u)alert(p);else{var t=e.responseJSON;alert(t&&t.displayMessage||p)}}})},a._toggle=function(e){e.find("button").toggleClass("se-placesMap-button-bookmark-saved")},a._showSavedGuide=function(e){var t=$seJq(k);e.append(t),setTimeout(function(){t.remove()},5e3)},t}(r.a);t.default=f}}]);